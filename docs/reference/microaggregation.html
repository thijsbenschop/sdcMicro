<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Microaggregation — microaggregation • sdcMicro</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
<meta property="og:title" content="Microaggregation — microaggregation" />

<meta property="og:description" content="Function to perform various methods of microaggregation." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sdcMicro</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">5.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/sdcMicro.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sdcTools/sdcMicro">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Microaggregation</h1>
    <small>Source: <a href='https://github.com/sdcTools/sdcMicro/blob/master/R/microaggregation.R'><code>R/microaggregation.R</code></a></small>
    </div>

    
    <p>Function to perform various methods of microaggregation.</p>
    

    <pre class="usage"><span class='fu'>microaggregation</span>(<span class='no'>obj</span>, <span class='kw'>variables</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>aggr</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>strata_variables</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"mdav"</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>nc</span> <span class='kw'>=</span> <span class='fl'>8</span>, <span class='kw'>clustermethod</span> <span class='kw'>=</span> <span class='st'>"clara"</span>,
  <span class='kw'>measure</span> <span class='kw'>=</span> <span class='st'>"mean"</span>, <span class='kw'>trim</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>varsort</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>transf</span> <span class='kw'>=</span> <span class='st'>"log"</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>obj</th>
      <td><p>either an object of class <code>sdcMicroObj-class</code> or a <code>data.frame</code></p></td>
    </tr>
    <tr>
      <th>variables</th>
      <td><p>variables to microaggregate. For <code>NULL</code>: If obj is of class
sdcMicroObj, all numerical key variables are chosen per default. For
<code>data.frames</code>, all columns are chosen per default.</p></td>
    </tr>
    <tr>
      <th>aggr</th>
      <td><p>aggregation level (default=3)</p></td>
    </tr>
    <tr>
      <th>strata_variables</th>
      <td><p>for <code>data.frames</code>, by-variables for applying microaggregation only
within strata defined by the variables. For <code>sdcMicroObj-class</code>-objects, the
stratification-variable defined in slot <code>@strataVar</code> is used. This slot can be changed any
time using <code>strataVar&lt;-</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>pca, rmd, onedims, single, simple, clustpca, pppca,
clustpppca, mdav, clustmcdpca, influence, mcdpca</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>sampling weights. If obj is of class sdcMicroObj the vector
of sampling weights is chosen automatically. If determined, a weighted
version of the aggregation measure is chosen automatically, e.g. weighted
median or weighted mean.</p></td>
    </tr>
    <tr>
      <th>nc</th>
      <td><p>number of cluster, if the chosen method performs cluster analysis</p></td>
    </tr>
    <tr>
      <th>clustermethod</th>
      <td><p>clustermethod, if necessary</p></td>
    </tr>
    <tr>
      <th>measure</th>
      <td><p>aggregation statistic, mean, median, trim, onestep (default=mean)</p></td>
    </tr>
    <tr>
      <th>trim</th>
      <td><p>trimming percentage, if measure=trim</p></td>
    </tr>
    <tr>
      <th>varsort</th>
      <td><p>variable for sorting, if method=single</p></td>
    </tr>
    <tr>
      <th>transf</th>
      <td><p>transformation for data x</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If &#8216;obj&#8217; was of class <code>sdcMicroObj-class</code> the corresponding
slots are filled, like manipNumVars, risk and utility. If &#8216;obj&#8217; was
of class &#8220;data.frame&#8221;, an object of class &#8220;micro&#8221; with following entities is returned:</p><ul>
<li><p><code>x</code>: original data</p></li>
<li><p><code>mx</code>: the microaggregated dataset</p></li>
<li><p><code>method</code>: method</p></li>
<li><p><code>aggr</code>: aggregation level</p></li>
<li><p><code>measure</code>: proximity measure for aggregation</p></li>
</ul>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>On <a href='http://neon.vb.cbs.nl/casc/Glossary.htm'>http://neon.vb.cbs.nl/casc/Glossary.htm</a> one can found the
&#8220;official&#8221; definition of microaggregation:</p>
<p>Records are grouped based on a proximity measure of variables of interest,
and the same small groups of records are used in calculating aggregates for
those variables. The aggregates are released instead of the individual
record values.</p>
<p>The recommended method is &#8220;rmd&#8221; which forms the proximity using
multivariate distances based on robust methods. It is an extension of the
well-known method &#8220;mdav&#8221;.  However, when computational speed is
important, method &#8220;mdav&#8221; is the preferable choice.</p>
<p>While for the proximity measure very different concepts can be used, the
aggregation itself is naturally done with the arithmetic mean.
Nevertheless, other measures of location can be used for aggregation,
especially when the group size for aggregation has been taken higher than 3.
Since the median seems to be unsuitable for microaggregation because of
being highly robust, other mesures which are included can be chosen. If a
complex sample survey is microaggregated, the corresponding sampling weights
should be determined to either aggregate the values by the weighted
arithmetic mean or the weighted median.</p>
<p>This function contains also a method with which the data can be clustered
with a variety of different clustering algorithms. Clustering observations
before applying microaggregation might be useful.  Note, that the data are
automatically standardised before clustering.</p>
<p>The usage of clustering method &#8216;Mclust&#8217; requires package mclust02,
which must be loaded first. The package is not loaded automatically, since
the package is not under GPL but comes with a different licence.</p>
<p>The are also some projection methods for microaggregation included.  The
robust version &#8216;pppca&#8217; or &#8216;clustpppca&#8217; (clustering at first)
are fast implementations and provide almost everytime the best results.</p>
<p>Univariate statistics are preserved best with the individual ranking method
(we called them &#8216;onedims&#8217;, however, often this method is named
&#8216;individual ranking&#8217;), but multivariate statistics are strong
affected.</p>
<p>With method &#8216;simple&#8217; one can apply microaggregation directly on the
(unsorted) data. It is useful for the comparison with other methods as a
benchmark, i.e. replies the question how much better is a sorting of the
data before aggregation.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>if only one variable is specified, <code><a href='mafast.html'>mafast</a></code> is applied and argument <code>method</code> is ignored.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p><a href='http://www.springerlink.com/content/v257655u88w2/?sortorder=asc&amp;p\_o=20'>http://www.springerlink.com/content/v257655u88w2/?sortorder=asc&amp;p\_o=20</a></p>
<p>Templ, M. and Meindl, B., <em>Robust Statistics Meets SDC: New Disclosure
Risk Measures for Continuous Microdata Masking</em>, Lecture Notes in Computer
Science, Privacy in Statistical Databases, vol. 5262, pp. 113-126, 2008.</p>
<p>Templ, M. <em>Statistical Disclosure Control for Microdata Using the
R-Package sdcMicro</em>, Transactions on Data Privacy, vol. 1, number 2, pp.
67-85, 2008.  <a href='http://www.tdp.cat/issues/abs.a004a08.php'>http://www.tdp.cat/issues/abs.a004a08.php</a></p>
<p>Templ, M. <em>New Developments in Statistical Disclosure Control and
Imputation: Robust Statistics Applied to Official Statistics</em>,
Suedwestdeutscher Verlag fuer Hochschulschriften, 2009, ISBN: 3838108280,
264 pages.</p>
<p>Templ, M. and Meindl, B. and Kowarik, A.: <em>Statistical Disclosure Control for
Micro-Data Using the R Package sdcMicro</em>, Journal of Statistical Software,
67 (4), 1--36, 2015.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='summary.micro.html'>summary.micro</a></code>, <code><a href='plotMicro.html'>plotMicro</a></code>,
<code><a href='valTable.html'>valTable</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>data</span>(<span class='no'>Tarragona</span>)
<span class='no'>m1</span> <span class='kw'>&lt;-</span> <span class='fu'>microaggregation</span>(<span class='no'>Tarragona</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>'onedims'</span>, <span class='kw'>aggr</span><span class='kw'>=</span><span class='fl'>3</span>)
<span class='co'>## summary(m1)</span>
<span class='fu'>data</span>(<span class='no'>testdata</span>)
<span class='no'>m2</span> <span class='kw'>&lt;-</span> <span class='fu'>microaggregation</span>(<span class='no'>testdata</span>[<span class='fl'>1</span>:<span class='fl'>100</span>,<span class='fu'>c</span>(<span class='st'>'expend'</span>,<span class='st'>'income'</span>,<span class='st'>'savings'</span>)],
  <span class='kw'>method</span><span class='kw'>=</span><span class='st'>'mdav'</span>, <span class='kw'>aggr</span><span class='kw'>=</span><span class='fl'>4</span>)
<span class='fu'>summary</span>(<span class='no'>m2</span>)</div><div class='output co'>#&gt; $meansx
#&gt;      expend             income            savings       
#&gt;  Min.   : 1106874   Min.   :    2897   Min.   :  11751  
#&gt;  1st Qu.:25977689   1st Qu.:27750000   1st Qu.:2620342  
#&gt;  Median :45716872   Median :44850000   Median :4771488  
#&gt;  Mean   :48440371   Mean   :49180278   Mean   :4798498  
#&gt;  3rd Qu.:69426340   3rd Qu.:70650000   3rd Qu.:6940269  
#&gt;  Max.   :98685205   Max.   :99600000   Max.   :9984098  
#&gt; 
#&gt; $meansxm
#&gt;      expend             income            savings       
#&gt;  Min.   :14471827   Min.   : 4482460   Min.   : 872137  
#&gt;  1st Qu.:22752145   1st Qu.:24675000   1st Qu.:2353262  
#&gt;  Median :42916487   Median :46850000   Median :5116959  
#&gt;  Mean   :48440371   Mean   :49180278   Mean   :4798498  
#&gt;  3rd Qu.:71888065   3rd Qu.:65000000   3rd Qu.:7020042  
#&gt;  Max.   :91918606   Max.   :93725000   Max.   :9407783  
#&gt; 
#&gt; $amean
#&gt; [1] 0
#&gt; 
#&gt; $amedian
#&gt; [1] 0.1782512
#&gt; 
#&gt; $aonestep
#&gt; [1] 0
#&gt; 
#&gt; $devvar
#&gt; [1] 0.3747106
#&gt; 
#&gt; $amad
#&gt; [1] 0.5343033
#&gt; 
#&gt; $acov
#&gt; [1] 0.1873553
#&gt; 
#&gt; $arcov
#&gt; [1] NA
#&gt; 
#&gt; $acor
#&gt; [1] 0.25935
#&gt; 
#&gt; $arcor
#&gt; [1] NA
#&gt; 
#&gt; $acors
#&gt; [1] 0.6424174
#&gt; 
#&gt; $adlm
#&gt; [1] 0.1699611
#&gt; 
#&gt; $adlts
#&gt; [1] NA
#&gt; 
#&gt; $apcaload
#&gt; [1] 0.6853318
#&gt; 
#&gt; $apppcaload
#&gt; [1] 2.27684
#&gt; 
#&gt; $totalsOrig
#&gt;     expend     income    savings 
#&gt; 4844037117 4918027777  479849813 
#&gt; 
#&gt; $totalsMicro
#&gt; numeric(0)
#&gt; 
#&gt; $atotals
#&gt; [1] 0
#&gt; 
#&gt; $pmtotals
#&gt; [1] 0
#&gt; 
#&gt; $util1
#&gt; [1] 53.39995
#&gt; 
#&gt; $deigenvalues
#&gt; [1] 0.0596172
#&gt; 
#&gt; $risk0
#&gt; [1] 0
#&gt; 
#&gt; $risk1
#&gt; [1] 0.29
#&gt; 
#&gt; $risk2
#&gt; [1] 0
#&gt; 
#&gt; $wrisk1
#&gt; [1] 0.7450012
#&gt; 
#&gt; $wrisk2
#&gt; [1] 0
#&gt; </div><div class='input'>
<span class='co'>## for objects of class sdcMicro:</span>
<span class='co'>## no stratification because @strataVar is NULL</span>
<span class='fu'>data</span>(<span class='no'>testdata2</span>)
<span class='no'>sdc</span> <span class='kw'>&lt;-</span> <span class='fu'>createSdcObj</span>(<span class='no'>testdata2</span>,
  <span class='kw'>keyVars</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>'urbrur'</span>,<span class='st'>'roof'</span>,<span class='st'>'walls'</span>,<span class='st'>'water'</span>,<span class='st'>'electcon'</span>,<span class='st'>'sex'</span>),
  <span class='kw'>numVars</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>'expend'</span>,<span class='st'>'income'</span>,<span class='st'>'savings'</span>), <span class='kw'>w</span><span class='kw'>=</span><span class='st'>'sampling_weight'</span>)
<span class='no'>sdc</span> <span class='kw'>&lt;-</span> <span class='fu'>microaggregation</span>(<span class='no'>sdc</span>, <span class='kw'>variables</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"expend"</span>,<span class='st'>"income"</span>))

<span class='co'>## with stratification by 'relat'</span>
<span class='fu'>strataVar</span>(<span class='no'>sdc</span>) <span class='kw'>&lt;-</span> <span class='st'>"relat"</span>
<span class='no'>sdc</span> <span class='kw'>&lt;-</span> <span class='fu'>microaggregation</span>(<span class='no'>sdc</span>, <span class='kw'>variables</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"savings"</span>))</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Matthias Templ, Bernhard Meindl

For method &#8220;mdav&#8221;: This work is being supported by the International
Household Survey Network (IHSN) and funded by a DGF Grant provided by the
World Bank to the PARIS21 Secretariat at the Organisation for Economic
Co-operation and Development (OECD).  This work builds on previous work
which is elsewhere acknowledged.

Author for the integration of the code for mdav in R: Alexander Kowarik.

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Bernhard Meindl, Alexander Kowarik, Matthias Templ.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>

